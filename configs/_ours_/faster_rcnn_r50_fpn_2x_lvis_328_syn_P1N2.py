_base_ = [
    '../_base_/models/faster_rcnn_r50_fpn.py',
    '../_ours_/lvis_v1_longtail_328.py',
    '../_base_/schedules/schedule_2x.py', '../_base_/default_runtime.py'
]

cat2label ={0: 9, 1: 13, 2: 17, 3: 20, 4: 30, 5: 31, 6: 38, 7: 39, 8: 40, 9: 42, 10: 46, 11: 49, 12: 51, 13: 52, 14: 63, 15: 71, 16: 74, 17: 78, 18: 82, 19: 85, 20: 93, 21: 100, 22: 101, 23: 106, 24: 113, 25: 117, 26: 119, 27: 123, 28: 126, 29: 130, 30: 131, 31: 134, 32: 136, 33: 140, 34: 147, 35: 149, 36: 151, 37: 155, 38: 159, 39: 161, 40: 164, 41: 168, 42: 172, 43: 179, 44: 180, 45: 202, 46: 209, 47: 210, 48: 211, 49: 214, 50: 222, 51: 224, 52: 231, 53: 233, 54: 234, 55: 236, 56: 237, 57: 238, 58: 240, 59: 244, 60: 250, 61: 251, 62: 258, 63: 262, 64: 265, 65: 269, 66: 270, 67: 275, 68: 279, 69: 281, 70: 282, 71: 287, 72: 289, 73: 291, 74: 292, 75: 295, 76: 300, 77: 301, 78: 302, 79: 304, 80: 307, 81: 308, 82: 310, 83: 313, 84: 314, 85: 316, 86: 317, 87: 321, 88: 323, 89: 326, 90: 333, 91: 339, 92: 343, 93: 348, 94: 349, 95: 352, 96: 354, 97: 355, 98: 356, 99: 360, 100: 362, 101: 364, 102: 366, 103: 368, 104: 374, 105: 376, 106: 381, 107: 382, 108: 388, 109: 389, 110: 397, 111: 398, 112: 405, 113: 407, 114: 414, 115: 416, 116: 420, 117: 426, 118: 427, 119: 428, 120: 431, 121: 432, 122: 434, 123: 439, 124: 446, 125: 454, 126: 456, 127: 458, 128: 467, 129: 470, 130: 478, 131: 479, 132: 480, 133: 481, 134: 482, 135: 483, 136: 486, 137: 488, 138: 491, 139: 492, 140: 503, 141: 504, 142: 506, 143: 508, 144: 513, 145: 516, 146: 518, 147: 526, 148: 527, 149: 531, 150: 532, 151: 533, 152: 535, 153: 538, 154: 541, 155: 542, 156: 543, 157: 545, 158: 551, 159: 557, 160: 561, 161: 567, 162: 568, 163: 571, 164: 572, 165: 574, 166: 575, 167: 576, 168: 577, 169: 580, 170: 582, 171: 583, 172: 585, 173: 597, 174: 599, 175: 602, 176: 603, 177: 606, 178: 607, 179: 610, 180: 616, 181: 618, 182: 619, 183: 625, 184: 632, 185: 634, 186: 635, 187: 640, 188: 646, 189: 648, 190: 657, 191: 660, 192: 662, 193: 663, 194: 664, 195: 665, 196: 671, 197: 672, 198: 674, 199: 678, 200: 686, 201: 688, 202: 690, 203: 691, 204: 710, 205: 712, 206: 714, 207: 718, 208: 722, 209: 727, 210: 729, 211: 730, 212: 733, 213: 743, 214: 754, 215: 758, 216: 759, 217: 764, 218: 769, 219: 770, 220: 772, 221: 777, 222: 778, 223: 779, 224: 783, 225: 784, 226: 785, 227: 788, 228: 803, 229: 808, 230: 810, 231: 812, 232: 815, 233: 820, 234: 822, 235: 823, 236: 824, 237: 829, 238: 831, 239: 842, 240: 849, 241: 850, 242: 851, 243: 852, 244: 853, 245: 855, 246: 856, 247: 858, 248: 862, 249: 864, 250: 869, 251: 873, 252: 886, 253: 887, 254: 890, 255: 894, 256: 902, 257: 905, 258: 908, 259: 913, 260: 917, 261: 918, 262: 920, 263: 925, 264: 931, 265: 933, 266: 936, 267: 937, 268: 938, 269: 939, 270: 941, 271: 944, 272: 945, 273: 956, 274: 958, 275: 969, 276: 972, 277: 975, 278: 983, 279: 987, 280: 990, 281: 991, 282: 992, 283: 994, 284: 997, 285: 998, 286: 1003, 287: 1004, 288: 1005, 289: 1010, 290: 1012, 291: 1015, 292: 1016, 293: 1028, 294: 1029, 295: 1030, 296: 1031, 297: 1047, 298: 1048, 299: 1049, 300: 1053, 301: 1057, 302: 1058, 303: 1075, 304: 1080, 305: 1084, 306: 1116, 307: 1118, 308: 1119, 309: 1120, 310: 1124, 311: 1126, 312: 1131, 313: 1132, 314: 1135, 315: 1144, 316: 1145, 317: 1146, 318: 1148, 319: 1150, 320: 1157, 321: 1158, 322: 1159, 323: 1165, 324: 1167, 325: 1181, 326: 1193, 327: 1201}

custom_imports = dict(imports=['configs._ours_.my_pipeline'], allow_failed_imports=False)


model = dict(
    roi_head=dict(
        bbox_head=dict(num_classes=328)),
    test_cfg=dict(
        rcnn=dict(
            score_thr=0.0001,
            # LVIS allows up to 300
            max_per_img=300)))
img_norm_cfg = dict(
    mean=[123.675, 116.28, 103.53], std=[58.395, 57.12, 57.375], to_rgb=True)
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(type='LoadAnnotations', with_bbox=True, with_mask=False),
    dict(type='In_N_Out',P=1,N=2),
    dict(
        type='Resize',
        img_scale=[(1333, 640), (1333, 672), (1333, 704), (1333, 736),
                   (1333, 768), (1333, 800)],
        multiscale_mode='value',
        keep_ratio=True),
    dict(type='RandomFlip', flip_ratio=0.5),
    dict(type='Normalize', **img_norm_cfg),
    dict(type='Pad', size_divisor=32),
    dict(type='DefaultFormatBundle'),
    dict(type='Collect', keys=['img', 'gt_bboxes', 'gt_labels']),
]
data = dict(train=dict(dataset=dict(pipeline=train_pipeline)))
evaluation = dict(classwise=True,remap_cat_id=cat2label)
##
load_from = 'https://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_fpn_2x_coco/faster_rcnn_r50_fpn_2x_coco_bbox_mAP-0.384_20200504_210434-a5d8aa15.pth'